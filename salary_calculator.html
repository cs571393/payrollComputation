<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工资计算器</title>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-color: #f8f9fa;
            --card-background: #ffffff;
            --text-color: #333;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --danger-color: #dc3545;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 15px;
            font-size: 16px;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: var(--card-background);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 25px;
        }
        .input-group {
            margin-bottom: 18px;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1rem;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
        .inline-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .inline-group label {
            flex-shrink: 0;
        }
        .inline-group p {
            margin: 0;
            font-weight: bold;
            color: var(--primary-color);
        }
        #calc-button {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #calc-button:hover {
            background-color: #0056b3;
        }
        #results {
            margin-top: 25px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: #fdfdff;
            display: none;
        }
        .result-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        .final-salary {
            font-size: 2rem;
            font-weight: bold;
            color: var(--success-color);
            text-align: center;
            margin-bottom: 20px;
        }
        #result-details ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #result-details li {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        #result-details li:last-child {
            border-bottom: none;
        }
        #result-details .value {
            font-weight: 500;
        }
        #result-details .income .value {
            color: var(--success-color);
        }
        #result-details .deduction .value {
            color: var(--danger-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>工资计算器</h1>

        <div class="input-group inline-group">
            <label for="month-selector">计算月份:</label>
            <select id="month-selector"></select>
            <p><span id="working-days">0</span> 工作日</p>
        </div>

        <div class="input-group">
            <label for="position-salary">岗位工资 (元)</label>
            <input type="number" id="position-salary" placeholder="请输入岗位工资">
        </div>
        
        <div class="input-group">
            <label for="performance-bonus">绩效奖金 (元)</label>
            <input type="number" id="performance-bonus" placeholder="请输入绩效奖金">
        </div>

        <div class="input-group">
            <label for="meal-allowance-rate">每日餐补 (元)</label>
            <input type="number" id="meal-allowance-rate" value="12">
        </div>

        <div class="input-group">
            <label for="full-attendance-bonus-amount">全勤奖 (元)</label>
            <input type="number" id="full-attendance-bonus-amount" value="100">
        </div>

        <div class="input-group">
            <label for="other-allowances">其他津贴/补贴 (元)</label>
            <input type="number" id="other-allowances" value="0" placeholder="请输入其他津贴/补贴">
        </div>

        <div class="input-group">
            <label for="leave-days">请假天数 (天)</label>
            <input type="number" id="leave-days" value="0" placeholder="请输入请假天数">
        </div>

        <div class="input-group">
            <label for="overtime-hours">加班时长 (小时)</label>
            <input type="number" id="overtime-hours" value="0" placeholder="请输入加班时长">
        </div>

        <div class="input-group">
            <label for="special-deduction">个税专项附加扣除 (元/月)</label>
            <input type="number" id="special-deduction" value="1000" placeholder="例如子女教育、住房贷款利息等">
        </div>

        <div class="input-group">
            <label for="other-deductions">其他合规扣款 (元)</label>
            <input type="number" id="other-deductions" value="0" placeholder="请输入其他扣款">
        </div>

        <button id="calc-button">计算</button>

        <div id="results">
            <p class="result-title">计算结果</p>
            <p class="final-salary" id="final-salary">¥ 0.00</p>
            <div id="result-details"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const monthSelector = document.getElementById('month-selector');
            const workingDaysEl = document.getElementById('working-days');
            
            const positionSalaryEl = document.getElementById('position-salary');
            const performanceBonusEl = document.getElementById('performance-bonus');
            const mealAllowanceRateEl = document.getElementById('meal-allowance-rate');
            const fullAttendanceBonusAmountEl = document.getElementById('full-attendance-bonus-amount');
            const otherAllowancesEl = document.getElementById('other-allowances');
            const leaveDaysEl = document.getElementById('leave-days');
            const overtimeHoursEl = document.getElementById('overtime-hours');
            const specialDeductionEl = document.getElementById('special-deduction');
            const otherDeductionsEl = document.getElementById('other-deductions');

            const calcButton = document.getElementById('calc-button');
            const resultsEl = document.getElementById('results');
            const finalSalaryEl = document.getElementById('final-salary');
            const resultDetailsEl = document.getElementById('result-details');

            const SOCIAL_SECURITY_DEDUCTION = 470.09;
            const TAX_THRESHOLD = 5000;

            const holidays = {
                '2024': {
                    holidays: ['2024-01-01', '2024-02-10', '2024-02-11', '2024-02-12', '2024-02-13', '2024-02-14', '2024-02-15', '2024-02-16', '2024-02-17', '2024-04-04', '2024-04-05', '2024-04-06', '2024-05-01', '2024-05-02', '2024-05-03', '2024-05-04', '2024-05-05', '2024-06-10', '2024-09-15', '2024-09-16', '2024-09-17', '2024-10-01', '2024-10-02', '2024-10-03', '2024-10-04', '2024-10-05', '2024-10-06', '2024-10-07'],
                    workdays: ['2024-02-04', '2024-02-18', '2024-04-07', '2024-04-28', '2024-05-11', '2024-09-14', '2024-09-29', '2024-10-12']
                },
                '2025': {
                    holidays: [], // 2025年放假安排待官方公布
                    workdays: []
                },
                '2026': {
                     holidays: ['2026-01-01', '2026-01-02', '2026-01-03', '2026-02-17', '2026-02-18', '2026-02-19', '2026-02-20', '2026-02-21', '2026-02-22', '2026-02-23', '2026-04-04', '2026-04-05', '2026-04-06', '2026-05-01', '2026-05-02', '2026-05-03', '2026-05-04', '2026-05-05', '2026-06-19', '2026-06-20', '2026-06-21', '2026-10-01', '2026-10-02', '2026-10-03', '2026-10-04', '2026-10-05', '2026-10-06', '2026-10-07', '2026-10-08'],
                    workdays: ['2026-02-15', '2026-02-28', '2026-04-12', '2026-04-25', '2026-05-09', '2026-09-27', '2026-10-10', '2026-10-11']
                }
            };

            function getWorkingDays(year, month) {
                const yearStr = String(year);
                const holidayData = holidays[yearStr] || { holidays: [], workdays: [] };
                const holidaySet = new Set(holidayData.holidays);
                const workdaySet = new Set(holidayData.workdays);

                const daysInMonth = new Date(year, month, 0).getDate();
                let count = 0;
                for (let day = 1; day <= daysInMonth; day++) {
                    const d = new Date(year, month - 1, day);
                    const dayOfWeek = d.getDay(); // 0: Sun, 6: Sat
                    const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

                    let isWorkday = true;

                    // Rule 1: Is it a statutory holiday?
                    if (holidaySet.has(dateStr)) {
                        isWorkday = false;
                    } 
                    // Rule 2: Is it a regular weekend?
                    else if (dayOfWeek === 0 || dayOfWeek === 6) {
                        isWorkday = false;
                    }

                    // Rule 3: Is it a special make-up workday? (This overrides rules 1 and 2)
                    if (workdaySet.has(dateStr)) {
                        isWorkday = true;
                    }
                    
                    if (isWorkday) {
                        count++;
                    }
                }
                return count;
            }

            function populateMonths() {
                const now = new Date();
                const currentYear = now.getFullYear();
                const currentMonth = now.getMonth() + 1;

                // Populate for a wider range, e.g., from 2024 to 2026
                for (let year = 2024; year <= 2026; year++) {
                    for (let month = 1; month <= 12; month++) {
                        const option = document.createElement('option');
                        option.value = `${year}-${month}`;
                        option.textContent = `${year}年 ${month}月`;
                        
                        if (year === currentYear && month === currentMonth) {
                            option.selected = true;
                        }
                        monthSelector.appendChild(option);
                    }
                }
                updateWorkingDays();
            }

            function updateWorkingDays() {
                const [year, month] = monthSelector.value.split('-').map(Number);
                const days = getWorkingDays(year, month);
                workingDaysEl.textContent = days;
            }
            
            function calculateTax(taxableIncome) {
                if (taxableIncome <= 0) return 0;
                
                const annualTaxableIncome = taxableIncome * 12;
                let tax = 0;

                // 个人所得税税率表（年度）
                if (annualTaxableIncome <= 36000) {
                    tax = annualTaxableIncome * 0.03;
                } else if (annualTaxableIncome <= 144000) {
                    tax = annualTaxableIncome * 0.10 - 2520;
                } else if (annualTaxableIncome <= 300000) {
                    tax = annualTaxableIncome * 0.20 - 16920;
                } else if (annualTaxableIncome <= 420000) {
                    tax = annualTaxableIncome * 0.25 - 31920;
                } else if (annualTaxableIncome <= 660000) {
                    tax = annualTaxableIncome * 0.30 - 52920;
                } else if (annualTaxableIncome <= 960000) {
                    tax = annualTaxableIncome * 0.35 - 85920;
                } else {
                    tax = annualTaxableIncome * 0.45 - 181920;
                }
                
                return tax / 12;
            }

            function calculate() {
                const positionSalary = parseFloat(positionSalaryEl.value) || 0;
                if (positionSalary === 0) {
                    alert('请输入岗位工资！');
                    return;
                }

                const performanceBonus = parseFloat(performanceBonusEl.value) || 0;
                const mealAllowanceRate = parseFloat(mealAllowanceRateEl.value) || 0;
                const fullAttendanceBonusAmount = parseFloat(fullAttendanceBonusAmountEl.value) || 0;
                const otherAllowances = parseFloat(otherAllowancesEl.value) || 0;
                const leaveDays = parseFloat(leaveDaysEl.value) || 0;
                const overtimeHours = parseFloat(overtimeHoursEl.value) || 0;
                const specialDeduction = parseFloat(specialDeductionEl.value) || 0;
                const otherDeductions = parseFloat(otherDeductionsEl.value) || 0;

                const workingDays = parseInt(workingDaysEl.textContent, 10);
                
                // --- 计算各项 ---
                const fullAttendanceBonus = leaveDays === 0 ? fullAttendanceBonusAmount : 0;
                const mealAllowance = Math.max(0, workingDays - leaveDays) * mealAllowanceRate;
                
                if (workingDays === 0) {
                    alert("当月没有工作日，无法计算日薪和时薪！");
                    return;
                }
                
                const dailySalary = positionSalary / workingDays;
                const hourlyRate = dailySalary / 8;

                const overtimePay = overtimeHours * hourlyRate;
                const leaveDeductionAmount = dailySalary * leaveDays;

                // 应发工资 (计税基数)
                const grossIncome = (positionSalary - leaveDeductionAmount) + performanceBonus + mealAllowance + fullAttendanceBonus + otherAllowances + overtimePay;

                // 应纳税所得额
                const incomeForTax = grossIncome - SOCIAL_SECURITY_DEDUCTION - specialDeduction - TAX_THRESHOLD;
                const tax = calculateTax(incomeForTax);

                // 实发工资
                const finalSalary = grossIncome - SOCIAL_SECURITY_DEDUCTION - tax - otherDeductions;
                
                // --- 显示结果 ---
                resultsEl.style.display = 'block';
                finalSalaryEl.textContent = `¥ ${finalSalary.toFixed(2)}`;
                
                resultDetailsEl.innerHTML = `
                    <ul>
                        <li class="income"><span>(+) 岗位工资</span><span class="value">¥ ${positionSalary.toFixed(2)}</span></li>
                        <li class="income"><span>(+) 绩效奖金</span><span class="value">¥ ${performanceBonus.toFixed(2)}</span></li>
                        <li class="income"><span>(+) 全勤奖</span><span class="value">¥ ${fullAttendanceBonus.toFixed(2)}</span></li>
                        <li class="income"><span>(+) 餐补</span><span class="value">¥ ${mealAllowance.toFixed(2)}</span></li>
                        <li class="income"><span>(+) 其他补贴</span><span class="value">¥ ${otherAllowances.toFixed(2)}</span></li>
                        <li class="income"><span>(+) 加班费</span><span class="value">¥ ${overtimePay.toFixed(2)}</span></li>
                        <li class="deduction"><span>(-) 请假扣款</span><span class="value">- ¥ ${leaveDeductionAmount.toFixed(2)}</span></li>
                        <li style="border-top: 1px solid var(--border-color); font-weight: bold;">
                            <span>应发工资</span><span class="value">¥ ${grossIncome.toFixed(2)}</span>
                        </li>
                        <li class="deduction"><span>(-) 社保个人部分</span><span class="value">- ¥ ${SOCIAL_SECURITY_DEDUCTION.toFixed(2)}</span></li>
                        <li class="deduction"><span>(-) 个人所得税</span><span class="value">- ¥ ${tax.toFixed(2)}</span></li>
                        <li class="deduction"><span>(-) 其他合规扣款</span><span class="value">- ¥ ${otherDeductions.toFixed(2)}</span></li>
                    </ul>
                `;
            }

            monthSelector.addEventListener('change', updateWorkingDays);
            calcButton.addEventListener('click', calculate);

            populateMonths();
        });
    </script>
</body>
</html>